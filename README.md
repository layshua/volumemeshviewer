# VolumeMeshViewer: å››é¢ä½“ç½‘æ ¼ç”Ÿæˆä¸å¯è§†åŒ–å·¥å…·

è¿™æ˜¯ä¸€ä¸ªåŸºäº WebAssembly (WASM) å’Œ Three.js çš„é«˜æ€§èƒ½ Web åº”ç”¨ç¨‹åºï¼Œç”¨äºåœ¨æµè§ˆå™¨ä¸­ç›´æ¥å°† 3D è¡¨é¢æ¨¡å‹ç”Ÿæˆå››é¢ä½“ç½‘æ ¼å¹¶è¿›è¡Œå¯è§†åŒ–ã€‚

è¯¥å·¥å…·åˆ©ç”¨ Emscripten å°† C++ å››é¢ä½“åŒ–åº“ç¼–è¯‘ä¸º WASMï¼Œå®ç°äº†å®¢æˆ·ç«¯çš„å¿«é€Ÿç½‘æ ¼ç”Ÿæˆï¼Œç»“åˆ GPU åŠ é€Ÿæ¸²æŸ“ï¼Œæä¾›äº†æµç•…çš„äº¤äº’ä½“éªŒã€‚

## âœ¨ ä¸»è¦åŠŸèƒ½

### 1. å¹¿æ³›çš„æ ¼å¼æ”¯æŒ

- æ”¯æŒå¯¼å…¥å¤šç§æ ‡å‡† 3D æ–‡ä»¶æ ¼å¼ï¼š
  - **OBJ** (.obj)
  - **STL** (.stl)
  - **PLY** (.ply)
  - **OFF** (.off)
  - **MESH** (.mesh)
  - **MESHB** (.meshb)
- è‡ªåŠ¨æ£€æµ‹ä¸æ”¯æŒçš„æ ¼å¼ï¼ˆå¦‚ GLTF/GLBï¼‰å¹¶æç¤ºè½¬æ¢ã€‚

### 2. å‚æ•°åŒ–å››é¢ä½“ç½‘æ ¼ç”Ÿæˆ

æä¾›çµæ´»çš„å‚æ•°è°ƒæ•´ä»¥æ§åˆ¶ç”Ÿæˆçš„ç½‘æ ¼è´¨é‡ï¼š

- **Preprocess Surface**: æ˜¯å¦å¯¹è¾“å…¥è¡¨é¢ç½‘æ ¼è¿›è¡Œé¢„å¤„ç†ã€‚
- **Refine Mesh**: æ˜¯å¦åœ¨ç”Ÿæˆè¿‡ç¨‹ä¸­ç»†åŒ–ç½‘æ ¼ã€‚
- **Quality Parameter**: è´¨é‡å‚æ•°æ§åˆ¶ï¼ˆèŒƒå›´ 0.1 - 10.0ï¼‰ï¼Œæ•°å€¼è¶Šå°è´¨é‡è¶Šé«˜ã€‚
- **å®æ—¶ç»Ÿè®¡**: ç”Ÿæˆå®Œæˆåæ˜¾ç¤ºé¡¶ç‚¹æ•°ã€å››é¢ä½“æ•°åŠè¡¨é¢é¢ç‰‡æ•°ã€‚

### 3. å¤šç§å¯è§†åŒ–æ¨¡å¼

- **Surface Facets**: ä»…æ˜¾ç¤ºå››é¢ä½“ç½‘æ ¼çš„è¡¨é¢ï¼Œé…åˆè·ç¦»åœºç€è‰²ã€‚
- **Tetrahedral Wireframe**: æ˜¾ç¤ºæ‰€æœ‰å››é¢ä½“çš„çº¿æ¡†ç»“æ„ï¼Œä¾¿äºè§‚å¯Ÿå†…éƒ¨æ‹“æ‰‘ã€‚
- **Tetrahedral Shrink**: "ç¼©å‡"æ¨¡å¼ï¼Œå°†æ¯ä¸ªå››é¢ä½“å‘ä¸­å¿ƒæ”¶ç¼©ï¼Œç›´è§‚å±•ç¤ºå†…éƒ¨ä½“ç§¯å•å…ƒã€‚æ”¯æŒè°ƒèŠ‚æ”¶ç¼©å› å­ (Shrink Factor)ã€‚

### 4. äº¤äº’å¼å‰–åˆ‡ (Clipping)

å¼ºå¤§çš„å‰–åˆ‡åŠŸèƒ½ï¼Œå¸®åŠ©æŸ¥çœ‹æ¨¡å‹å†…éƒ¨ç»“æ„ï¼š

- æ”¯æŒ **X, Y, Z** ä¸‰è½´ç‹¬ç«‹å‰–åˆ‡ã€‚
- æ”¯æŒ**åå‘ (Flip)** å‰–åˆ‡æ–¹å‘ã€‚
- **Show Plane Helpers**: å¯è§†åŒ–å‰–åˆ‡å¹³é¢çš„ä½ç½®ã€‚
- åŸºäº Shader çš„é«˜æ€§èƒ½ GPU å‰–åˆ‡ï¼ˆä½¿ç”¨ discard å’Œ varying ä¼ é€’æŠ€æœ¯ï¼Œä¸ä¾èµ– WebGL æ‰©å±•ï¼‰ã€‚

### 5. å¢å¼ºçš„æ¸²æŸ“æ•ˆæœ

- **è·ç¦»åœºç€è‰²**: æ ¹æ®é¡¶ç‚¹åˆ°åŸç‚¹çš„è·ç¦»è‡ªåŠ¨åº”ç”¨çƒ­åŠ›å›¾é¢œè‰²ï¼ˆæ·±è“ -> é’ -> ç»¿ -> é»„ -> çº¢ï¼‰ï¼Œå¢å¼ºç©ºé—´æ„Ÿã€‚
- **å…‰ç…§æ•ˆæœ**: ç®€å•çš„æ–¹å‘å…‰å’Œç¯å¢ƒå…‰ï¼Œé…åˆæè´¨å¢å¼ºç«‹ä½“æ„Ÿã€‚

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

- **Frontend**: HTML5, Vanilla JavaScript, CSS3 (Modern/Responsive)
- **Rendering**: [Three.js](https://threejs.org/) (WebGL)
- **Core Logic**: C++ (Compiled to WebAssembly via Emscripten)
- **Architecture**:
  - Main Thread: UI & Rendering
  - WASM: CPU-intensive Mesh Generation (Tetrahedralization)

## ğŸš€ ä½¿ç”¨æŒ‡å—

1. **åŠ è½½æ¨¡å‹**:

   - ç‚¹å‡» "Choose File" é€‰æ‹©æœ¬åœ° 3D æ–‡ä»¶ã€‚
   - æˆ–è€…ç›´æ¥ä½¿ç”¨é»˜è®¤å†…ç½®çš„ `bunny.obj` è¿›è¡Œæµ‹è¯•ã€‚

2. **ç”Ÿæˆç½‘æ ¼**:

   - è°ƒæ•´ **Tetrahedralization** åŒºåŸŸçš„å‚æ•°ï¼ˆQuality ç­‰ï¼‰ã€‚
   - ç‚¹å‡» **Generate Tetrahedral Mesh** æŒ‰é’®ã€‚
   - è§‚å¯Ÿæ§åˆ¶å°æ—¥å¿—å’ŒçŠ¶æ€æ äº†è§£è¿›åº¦ã€‚

3. **å¯è§†åŒ–æŸ¥çœ‹**:

   - åœ¨ **Visualization** åŒºåŸŸé€‰æ‹©ä¸åŒçš„ `Display Mode`ã€‚
   - å¦‚æœé€‰æ‹©äº† `Tetrahedral Shrink`ï¼Œè¯•ç€æ‹–åŠ¨ slider è°ƒæ•´æ”¶ç¼©ç¨‹åº¦ã€‚

4. **å†…éƒ¨å‰–åˆ‡**:
   - å‹¾é€‰ **Clipping Planes** ä¸­çš„ Clip X/Y/Zã€‚
   - æ‹–åŠ¨æ»‘å—ç§»åŠ¨å‰–åˆ‡å¹³é¢ã€‚
   - ä½¿ç”¨ Flip æ”¹å˜ä¿ç•™çš„ä¸€ä¾§ã€‚

## ğŸ“¦ å®‰è£…ä¸è¿è¡Œ

æœ¬åº”ç”¨ä¸ºçº¯é™æ€ç½‘é¡µï¼Œä¾èµ– WASM æ¨¡å—ã€‚

1. ç¡®ä¿ä½ æœ‰ `tetrahedralize_js.js` å’Œå¯¹åº”çš„ WASM æ–‡ä»¶ã€‚
2. ä½¿ç”¨æœ¬åœ°æœåŠ¡å™¨è¿è¡Œï¼ˆç”±äºæµè§ˆå™¨å®‰å…¨ç­–ç•¥ï¼ŒWASM å’Œæ–‡ä»¶åŠ è½½é€šå¸¸éœ€è¦æœåŠ¡å™¨ç¯å¢ƒï¼‰ï¼š

   ```bash
   # ä½¿ç”¨ Python
   python -m http.server 8000

   # æˆ–è€…ä½¿ç”¨ Node.js http-server
   npx http-server .
   ```

3. è®¿é—® `http://localhost:8000`ã€‚
